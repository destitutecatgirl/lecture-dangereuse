<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lecture Dangereuse</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Georgia, serif; background: #0a0806; color: #e8e4dc; min-height: 100vh; }
        
        .container { max-width: 1200px; margin: 0 auto; padding: 1rem; }
        
        header { border-bottom: 1px solid #2a2015; padding: 1rem; margin-bottom: 1rem; }
        h1 { font-size: 1.25rem; color: #c4a060; font-weight: 400; letter-spacing: 0.1em; }
        .subtitle { font-size: 0.65rem; color: #6b6050; margin-top: 0.25rem; }
        
        nav { display: flex; gap: 0.5rem; margin-top: 0.75rem; flex-wrap: wrap; }
        .nav-btn { 
            background: none; border: none; color: #6b6050; 
            font-size: 0.7rem; padding: 0.5rem 0.75rem; cursor: pointer; 
            font-family: Georgia, serif; text-transform: uppercase; letter-spacing: 0.05em;
        }
        .nav-btn.active { color: #c4a060; background: #12100a; }
        .nav-btn:hover { color: #c4a060; }
        
        .warning { background: #1a1210; border-left: 2px solid #a07060; padding: 0.75rem; margin-bottom: 1rem; font-size: 0.8rem; color: #a09080; }
        
        .main { display: flex; flex-direction: column; gap: 1rem; }
        @media (min-width: 768px) { .main { flex-direction: row; } }
        
        .left { flex: 1; }
        .right { flex: 0 0 40%; background: #0d0b08; padding: 1rem; border-left: 1px solid #2a2015; min-height: 300px; }
        @media (max-width: 767px) { .right { border-left: none; border-top: 1px solid #2a2015; } }
        
        textarea, input[type="text"], input[type="password"] {
            width: 100%; padding: 0.75rem; background: #12100a; border: 1px solid #2a2015;
            color: #e8e4dc; font-family: Georgia, serif; font-size: 1rem; margin-bottom: 0.5rem;
        }
        textarea:focus, input:focus { outline: none; border-color: #c4a060; }
        
        .btn { 
            padding: 0.6rem 1rem; border: none; cursor: pointer; 
            font-family: Georgia, serif; font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.05em;
        }
        .btn-primary { background: #c4a060; color: #0a0806; }
        .btn-secondary { background: #2a2015; color: #e8e4dc; }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        
        .reading { font-size: 1.1rem; line-height: 2; }
        .sentence { padding: 0.5rem; margin-bottom: 0.25rem; border-left: 2px solid transparent; }
        .sentence.selected { background: #12100a; border-left-color: #c4a060; }
        .word { cursor: pointer; padding: 0.1rem; }
        .word:hover { background: rgba(196,160,96,0.2); }
        .word.selected { background: #c4a060; color: #0a0806; }
        .word.in-lexicon { color: #c4a060; border-bottom: 1px dotted #c4a060; }
        
        .sample { background: #12100a; border: 1px solid #2a2015; padding: 0.75rem; margin-bottom: 0.5rem; cursor: pointer; }
        .sample:hover { border-color: #c4a060; }
        .sample h3 { font-size: 0.9rem; color: #c4a060; font-weight: 400; margin-bottom: 0.25rem; }
        .sample p { font-size: 0.8rem; color: #6b6050; }
        
        .box { padding: 0.75rem; margin-bottom: 0.5rem; background: #12100a; border-left: 2px solid #2a2015; }
        .box .label { font-size: 0.6rem; color: #6b6050; text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 0.25rem; }
        .box p { font-size: 0.9rem; line-height: 1.5; }
        .box-accent { border-color: #c4a060; }
        .box-accent .label { color: #c4a060; }
        .box-warn { border-color: #a07060; }
        .box-warn .label { color: #a07060; }
        .box-danger { border-color: #c06060; background: #1a0a0a; }
        .box-danger .label { color: #c06060; }
        .box-trans { border-color: #607080; }
        .box-trans .label { color: #607080; }
        
        .message { padding: 0.75rem; margin-bottom: 0.5rem; }
        .message.user { background: #1a1810; }
        .message.assistant { background: #12100a; border-left: 2px solid #c4a060; }
        .message .role { font-size: 0.6rem; color: #6b6050; text-transform: uppercase; margin-bottom: 0.25rem; }
        .message .content { font-size: 0.9rem; white-space: pre-wrap; line-height: 1.6; }
        
        .section-label { font-size: 0.65rem; color: #6b6050; text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 0.5rem; }
        .empty { text-align: center; padding: 2rem; color: #6b6050; }
        
        .modal-bg { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.85); display: flex; align-items: center; justify-content: center; padding: 1rem; z-index: 100; }
        .modal { background: #12100a; border: 1px solid #2a2015; padding: 1.5rem; max-width: 450px; width: 100%; }
        .modal h2 { font-size: 1.1rem; color: #c4a060; font-weight: 400; margin-bottom: 0.75rem; }
        .modal p { font-size: 0.85rem; color: #a09080; margin-bottom: 1rem; line-height: 1.5; }
        
        .critique { background: #0d0808; border: 1px solid #c06060; padding: 1rem; margin-bottom: 1rem; }
        .critique h4 { font-size: 0.7rem; color: #c06060; text-transform: uppercase; margin-bottom: 0.5rem; }
        .critique p { font-size: 0.85rem; color: #a09080; line-height: 1.5; }
        
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .gap-1 { gap: 0.5rem; }
        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .loading { color: #c4a060; font-style: italic; }
    </style>
</head>
<body>
<div id="app"><div class="empty">Loading...</div></div>

<script>
// ========== LEXICON ==========
const LEXICON = {
    "violence": {
        term: "violence",
        def: "Not aberration but foundation. Colonial peace is colonial violence.",
        thinkers: "Fanon, Les Damnés de la Terre",
        analysis: "Decolonization is always violent because colonization is violence. The violence of the colonized is response, not initiation.",
        material: "Algeria 1954-62: 1.5 million dead. Every 'peaceful' colony maintained by gun and whip.",
        danger: "Names the violence that liberalism calls 'order'"
    },
    "colonisé": {
        term: "colonisé / the colonized",
        def: "Not passive state but active production. The colonizer makes the colonized.",
        thinkers: "Fanon, Memmi",
        analysis: "The colonized is manufactured through violence, law, economy, psychology. Made to serve colonial extraction.",
        material: "Passes, reserves, bantustans, ghettos—spatial technologies of subjection.",
        danger: "Shows colonial subjects are made, not born—therefore can be unmade"
    },
    "décolonisation": {
        term: "décolonisation / decolonization",
        def: "Not reform but rupture. Not inclusion but destruction of the colonial world.",
        thinkers: "Fanon",
        analysis: "'Decolonization is always a violent phenomenon.' It is not negotiation but the creation of new humanity.",
        material: "Algeria. Kenya. Vietnam. Haiti 1804.",
        danger: "Demands the end of the world as currently structured"
    },
    "civilisation": {
        term: "civilisation / civilization",
        def: "The name colonialism gives itself. The alibi for violence.",
        thinkers: "Césaire, Discours sur le colonialisme",
        analysis: "'A civilization that colonizes is already sick.' Civilization is not the opposite of barbarism—it is its mask.",
        material: "The 'civilizing mission.' Schools that beat languages out of children. Museums of stolen objects.",
        danger: "Unmasks civilization as violence"
    },
    "nécropolitique": {
        term: "nécropolitique / necropolitics",
        def: "The politics of death. Power over who lives and who must die.",
        thinkers: "Mbembe",
        analysis: "Beyond biopolitics (managing life) to necropolitics (managing death). Sovereignty as the capacity to kill.",
        material: "Gaza. The Mediterranean. The prison. COVID-19 and who was left to die.",
        danger: "Names the death-dealing that calls itself democracy"
    },
    "opacité": {
        term: "opacité / opacity",
        def: "The right to not be understood. Against the colonial demand for transparency.",
        thinkers: "Glissant, Poétique de la Relation",
        analysis: "'Consent not merely to difference but to opacity.' I don't need to understand you to respect you.",
        material: "What survived the Middle Passage precisely because it was opaque to the master.",
        danger: "Refuses the terms of Western knowledge production"
    },
    "relation": {
        term: "relation",
        def: "Against identity, relation. Against roots, rhizomes. Identity through connection.",
        thinkers: "Glissant",
        analysis: "The Caribbean as model: where Africa, Europe, Asia, Indigenous Americas met in violence and created something new.",
        danger: "Destroys the concept of authentic identity"
    },
    "chair": {
        term: "chair / flesh",
        def: "Before the body there is flesh. The zero degree of social conceptualization.",
        thinkers: "Spillers, 'Mama's Baby, Papa's Maybe'",
        analysis: "The captive body became flesh—ungendered, opened, violated. The distinction between free and captive.",
        material: "The hold of the ship. The auction block. The whip.",
        danger: "Names what happened to Black women that feminism cannot think"
    },
    "afterlife": {
        term: "afterlife of slavery",
        def: "Slavery did not end. It transformed. Prison, ghetto, premature death.",
        thinkers: "Hartman, Lose Your Mother",
        analysis: "'Slavery established a measure of man and ranking of life that has yet to be undone.'",
        material: "13th Amendment: slavery except as punishment. 2.3 million incarcerated.",
        danger: "Makes abolition necessary—reform is impossible"
    },
    "abolition": {
        term: "abolition",
        def: "Not reform but ending. Not improving the prison but making it unnecessary.",
        thinkers: "Davis, Gilmore, Kaba",
        analysis: "Building what makes prisons unthinkable—care, housing, education, health.",
        material: "The 19th century movement. Prison strikes. Defund campaigns.",
        danger: "Refuses to negotiate with the machinery of death"
    },
    "en effet": { term: "en effet", def: "Indeed / in fact. Confirms and intensifies what precedes.", type: "grammar" },
    "dès lors": { term: "dès lors", def: "From then on / therefore / consequently.", type: "grammar" },
    "or": { term: "or", def: "Now / but / however. NOT 'or' in English.", type: "grammar" },
    "certes": { term: "certes", def: "Certainly / admittedly. Concedes before counter-argument.", type: "grammar" },
    "autrui": { term: "autrui", def: "The other (philosophical). The Other as concept.", type: "grammar" },
    "soit": { term: "soit", def: "Either...or / that is / let it be.", type: "grammar" },
    "voire": { term: "voire", def: "Even / or even. Intensifies the claim.", type: "grammar" },
    "pourtant": { term: "pourtant", def: "Yet / however / nevertheless.", type: "grammar" }
};

const TEXTS = [
    { id: "1", title: "Fanon - Les Damnés de la Terre", content: "La décolonisation, qui se propose de changer l'ordre du monde, est, on le voit, un programme de désordre absolu. Mais elle ne peut être le résultat d'une opération magique, d'une secousse naturelle ou d'une entente à l'amiable." },
    { id: "2", title: "Césaire - Discours sur le colonialisme", content: "Une civilisation qui s'avère incapable de résoudre les problèmes que suscite son fonctionnement est une civilisation décadente. Une civilisation qui choisit de fermer les yeux à ses problèmes les plus cruciaux est une civilisation atteinte." },
    { id: "3", title: "Glissant - Le droit à l'opacité", content: "Consentons au droit à l'opacité. Il ne m'est pas nécessaire de te « comprendre » pour me sentir solidaire de toi, pour bâtir avec toi, pour aimer ce que tu fais." },
    { id: "4", title: "Mbembe - Nécropolitique", content: "L'expression ultime de la souveraineté réside largement dans le pouvoir et la capacité de décider qui peut vivre et qui doit mourir." }
];

// ========== STATE ==========
const state = {
    apiKey: localStorage.getItem('api_key') || '',
    showModal: false,
    view: 'read',
    text: '',
    sentences: [],
    selectedWords: [],
    selectedSentence: null,
    analysis: null,
    translation: '',
    conversation: JSON.parse(localStorage.getItem('conv') || '[]'),
    convInput: '',
    loading: {}
};

// ========== API ==========
async function callAPI(prompt, max = 1500) {
    if (!state.apiKey) throw new Error('No API key');
    const res = await fetch('https://api.anthropic.com/v1/messages', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'x-api-key': state.apiKey,
            'anthropic-version': '2023-06-01',
            'anthropic-dangerous-direct-browser-access': 'true'
        },
        body: JSON.stringify({
            model: 'claude-sonnet-4-20250514',
            max_tokens: max,
            messages: [{ role: 'user', content: prompt }]
        })
    });
    if (!res.ok) {
        if (res.status === 401) throw new Error('Invalid API key');
        throw new Error('API error: ' + res.status);
    }
    const data = await res.json();
    return data.content?.[0]?.text || '';
}

// ========== FUNCTIONS ==========
function saveKey(k) {
    state.apiKey = k;
    localStorage.setItem('api_key', k);
    state.showModal = false;
    render();
}

function parse(text) {
    state.text = text;
    state.sentences = text.split(/(?<=[.!?»"])\s+/).filter(s => s.trim()).map((s, i) => ({
        id: i,
        text: s.trim(),
        words: s.trim().split(/\s+/).map((w, j) => ({
            id: `${i}-${j}`,
            text: w,
            clean: w.toLowerCase().replace(/[.,;:!?«»""''()\[\]–—]/g, '')
        }))
    }));
    render();
}

function findLex(w) {
    return LEXICON[w.toLowerCase().replace(/[.,;:!?«»""''()\[\]–—]/g, '')];
}

function clickWord(word, sentence, e) {
    state.selectedSentence = sentence;
    if (e.shiftKey || e.ctrlKey || e.metaKey) {
        const exists = state.selectedWords.find(w => w.id === word.id);
        state.selectedWords = exists ? state.selectedWords.filter(w => w.id !== word.id) : [...state.selectedWords, word];
    } else {
        state.selectedWords = [word];
    }
    state.analysis = findLex(word.clean);
    translate();
    render();
}

async function translate() {
    if (!state.selectedWords.length) return;
    const text = state.selectedWords.map(w => w.text).join(' ');
    const lex = findLex(text);
    if (lex) { state.translation = lex.def; render(); return; }
    if (!state.apiKey) { state.translation = 'Set API key for translation'; render(); return; }
    state.loading.trans = true; render();
    try {
        state.translation = await callAPI(`Translate to English precisely: "${text}"`, 200);
    } catch (e) { state.translation = 'Error: ' + e.message; }
    state.loading.trans = false; render();
}

async function analyze() {
    if (!state.selectedWords.length || !state.apiKey) return;
    const text = state.selectedWords.map(w => w.text).join(' ');
    state.loading.analysis = true; render();
    try {
        const r = await callAPI(`You are a scholar of decolonial thought. Analyze: "${text}"
Context: "${state.selectedSentence?.text || ''}"
Give: translation, thinkers who use it, theoretical weight, material conditions, contemporary relevance, what gets lost in this definition.
JSON format: {"term":"","def":"","thinkers":"","analysis":"","material":"","danger":""}`);
        const m = r.match(/\{[\s\S]*\}/);
        if (m) state.analysis = JSON.parse(m[0]);
    } catch (e) { console.error(e); }
    state.loading.analysis = false; render();
}

async function send() {
    if (!state.convInput?.trim() || !state.apiKey) return;
    const msg = state.convInput;
    state.conversation.push({ role: 'user', content: msg });
    state.convInput = '';
    state.loading.conv = true; render();
    try {
        const ctx = state.sentences.map(s => s.text).join(' ');
        const r = await callAPI(`You are a lecturer in decolonial studies, Black radical thought, critical theory.
You teach Fanon, Césaire, Glissant, Spillers, Hartman, Wynter, Sharpe, Moten, Wilderson, Mbembe, Davis, Gilmore, Robinson, hooks, Lorde.
You do not soften. You name violence directly. You distinguish between thinkers—they disagree.

Student is reading: "${ctx || '[no text]'}"
Previous: ${state.conversation.slice(-4).map(m => m.role + ': ' + m.content).join('\n')}
Student asks: "${msg}"

Respond as their lecturer. Be rigorous. Name debates.`);
        state.conversation.push({ role: 'assistant', content: r });
        localStorage.setItem('conv', JSON.stringify(state.conversation));
    } catch (e) {
        state.conversation.push({ role: 'assistant', content: 'Error: ' + e.message });
    }
    state.loading.conv = false; render();
    setTimeout(() => document.getElementById('conv-end')?.scrollIntoView({ behavior: 'smooth' }), 100);
}

// ========== RENDER ==========
function render() {
    const app = document.getElementById('app');
    
    if (state.showModal || !state.apiKey) {
        app.innerHTML = `
            <div class="modal-bg">
                <div class="modal">
                    <h2>LECTURE DANGEREUSE</h2>
                    <p>Enter your Anthropic API key. It's stored only in your browser.</p>
                    <input type="password" id="key-input" placeholder="sk-ant-..." value="${state.apiKey}">
                    <div class="flex gap-1 mt-1">
                        <button class="btn btn-primary" style="flex:1" onclick="saveKey(document.getElementById('key-input').value)">Save</button>
                        <button class="btn btn-secondary" onclick="state.showModal=false;state.view='about';render()">Skip</button>
                    </div>
                    <p style="font-size:0.75rem;color:#6b6050;margin-top:0.75rem">Get key at <a href="https://console.anthropic.com/" target="_blank" style="color:#c4a060">console.anthropic.com</a></p>
                </div>
            </div>`;
        return;
    }
    
    app.innerHTML = `
        <div class="container">
            <header>
                <h1>LECTURE DANGEREUSE</h1>
                <p class="subtitle">Fanon · Césaire · Glissant · Spillers · Hartman · Wynter · Mbembe</p>
                <nav>
                    <button class="nav-btn ${state.view==='read'?'active':''}" onclick="state.view='read';render()">Read</button>
                    <button class="nav-btn ${state.view==='converse'?'active':''}" onclick="state.view='converse';render()">Converse</button>
                    <button class="nav-btn ${state.view==='lexicon'?'active':''}" onclick="state.view='lexicon';render()">Lexicon</button>
                    <button class="nav-btn ${state.view==='about'?'active':''}" onclick="state.view='about';render()">About</button>
                    <button class="nav-btn" style="color:${state.apiKey?'#608060':'#a06060'}" onclick="state.showModal=true;render()">${state.apiKey?'API ✓':'API Key'}</button>
                </nav>
            </header>
            
            ${state.view !== 'about' ? `<div class="warning">⚠️ This tool reduces complex thought to definitions. It betrays the thinkers it claims to teach. Read the texts.</div>` : ''}
            
            <div class="main">
                <div class="left">${renderLeft()}</div>
                <div class="right">${renderRight()}</div>
            </div>
        </div>`;
}

function renderLeft() {
    if (state.view === 'read') {
        if (!state.sentences.length) {
            return `
                <p class="section-label">Paste text or choose sample · Click words to analyze</p>
                <textarea id="text-in" placeholder="Collez votre texte..." style="min-height:100px">${state.text}</textarea>
                <button class="btn btn-primary" onclick="parse(document.getElementById('text-in').value)">Begin →</button>
                <div class="mt-2">
                    <p class="section-label">Sample Texts</p>
                    ${TEXTS.map(t => `<div class="sample" onclick="parse(TEXTS.find(x=>x.id==='${t.id}').content)"><h3>${t.title}</h3><p>${t.content.substring(0,60)}...</p></div>`).join('')}
                </div>`;
        }
        return `
            <button class="nav-btn" onclick="state.sentences=[];state.selectedWords=[];state.analysis=null;render()">← New text</button>
            <div class="reading mt-1">
                ${state.sentences.map(s => `
                    <div class="sentence ${state.selectedSentence?.id===s.id?'selected':''}">
                        ${s.words.map(w => {
                            const sel = state.selectedWords.find(x => x.id === w.id);
                            const lex = findLex(w.clean);
                            return `<span class="word ${sel?'selected':''} ${lex?'in-lexicon':''}" onclick="clickWord(state.sentences[${s.id}].words[${s.words.indexOf(w)}],state.sentences[${s.id}],event)">${w.text}</span>`;
                        }).join('')}
                    </div>
                `).join('')}
            </div>`;
    }
    
    if (state.view === 'converse') {
        const ctx = state.sentences.map(s => s.text).join(' ');
        return `
            <div class="flex-col" style="height:100%">
                <div style="display:flex;justify-content:space-between;align-items:center">
                    <p class="section-label">Conversation</p>
                    ${state.conversation.length ? `<button class="nav-btn" onclick="state.conversation=[];localStorage.removeItem('conv');render()">Clear</button>` : ''}
                </div>
                <div style="flex:1;overflow-y:auto;max-height:50vh">
                    ${!state.conversation.length ? `<div class="empty">Load a text, then ask questions.</div>` : ''}
                    ${state.conversation.map(m => `<div class="message ${m.role}"><div class="role">${m.role==='user'?'You':'Lecturer'}</div><div class="content">${m.content}</div></div>`).join('')}
                    ${state.loading.conv ? '<p class="loading">Thinking...</p>' : ''}
                    <div id="conv-end"></div>
                </div>
                <div class="flex gap-1 mt-1">
                    <input type="text" id="conv-in" placeholder="${ctx?'Ask...':'Load text first'}" value="${state.convInput}" ${ctx?'':'disabled'} onkeydown="if(event.key==='Enter'){state.convInput=this.value;send()}" oninput="state.convInput=this.value">
                    <button class="btn btn-primary" onclick="send()" ${ctx?'':'disabled'}>Send</button>
                </div>
            </div>`;
    }
    
    if (state.view === 'lexicon') {
        const entries = Object.entries(LEXICON).filter(([k,v]) => !v.type);
        const grammar = Object.entries(LEXICON).filter(([k,v]) => v.type === 'grammar');
        return `
            <p class="section-label">Lexicon</p>
            <div class="critique"><h4>Warning</h4><p>This lexicon reduces. Each entry betrays its source. Use as starting point, not destination.</p></div>
            ${entries.map(([k,v]) => `
                <div class="sample" onclick="state.analysis=LEXICON['${k}'];render()">
                    <h3>${v.term}</h3>
                    <p>${v.def.substring(0,80)}...</p>
                </div>
            `).join('')}
            <p class="section-label mt-2">Grammar</p>
            ${grammar.map(([k,v]) => `
                <div class="sample" onclick="state.analysis=LEXICON['${k}'];render()">
                    <h3>${v.term}</h3>
                    <p>${v.def}</p>
                </div>
            `).join('')}
        `;
    }
    
    if (state.view === 'about') {
        return `
            <h2 style="color:#c4a060;font-size:1.1rem;font-weight:400;margin-bottom:1rem">About / Self-Critique</h2>
            
            <div class="critique">
                <h4>What This Tool Cannot Do</h4>
                <p>This reduces thought to definitions—violating Glissant's opacity. It assumes individual learning—ignoring that "study is what you do with other people" (Moten/Harney). It cannot teach liberation.</p>
            </div>
            
            <div class="box box-danger">
                <p class="label">The Problem</p>
                <p>An AI trained on Western/white corpus organizing how Fanon, Spillers, Césaire are encountered. This reproduces the colonial relation.</p>
            </div>
            
            <div class="box box-danger">
                <p class="label">The Form</p>
                <p>Building an app to teach decolonial thought is absurd. The form—individual consumption, progress tracking—is the subject-formation these thinkers critique.</p>
            </div>
            
            <div class="box box-accent mt-2">
                <p class="label">What To Do Instead</p>
                <p>Read the texts. Form a study group. Connect to actual struggle—prison abolition, housing, migrant solidarity. Sit with discomfort.</p>
            </div>
            
            <p class="section-label mt-2">Key Texts</p>
            <p style="font-size:0.85rem;line-height:1.6;color:#a09080">
                <strong>Fanon:</strong> Peau noire, masques blancs; Les Damnés de la Terre<br>
                <strong>Césaire:</strong> Cahier d'un retour au pays natal; Discours sur le colonialisme<br>
                <strong>Glissant:</strong> Poétique de la Relation<br>
                <strong>Spillers:</strong> "Mama's Baby, Papa's Maybe"<br>
                <strong>Hartman:</strong> Scenes of Subjection; Lose Your Mother<br>
                <strong>Sharpe:</strong> In the Wake<br>
                <strong>Moten/Harney:</strong> The Undercommons<br>
                <strong>Wilderson:</strong> Afropessimism<br>
                <strong>Mbembe:</strong> Nécropolitique<br>
                <strong>Davis:</strong> Are Prisons Obsolete?<br>
                <strong>Gilmore:</strong> Golden Gulag
            </p>
        `;
    }
    
    return '';
}

function renderRight() {
    if (state.view === 'about') return `<div class="empty">Read the texts.</div>`;
    
    if (!state.selectedWords.length && !state.analysis) {
        return `<div class="empty"><p>Click words to analyze</p><p style="font-size:0.8rem;margin-top:0.5rem">Shift+click for multiple</p><p style="margin-top:1rem;font-size:0.8rem"><span style="color:#c4a060;border-bottom:1px dotted #c4a060">Gold</span> = in lexicon</p></div>`;
    }
    
    const text = state.selectedWords.map(w => w.text).join(' ');
    const a = state.analysis || {};
    
    return `
        ${state.translation || state.loading.trans ? `
            <div class="box box-trans">
                <p class="label">${state.loading.trans ? 'Translating...' : 'Translation'}</p>
                <p style="color:#c0d0e0">${state.translation || '...'}</p>
            </div>
        ` : ''}
        
        ${text ? `
            <div style="margin-bottom:0.75rem">
                <p class="section-label">Selected</p>
                <h2 style="font-size:1.3rem;color:#c4a060;font-weight:400">${text}</h2>
            </div>
        ` : ''}
        
        ${state.loading.analysis ? '<p class="loading">Analyzing...</p>' : ''}
        
        ${a.def ? `<div class="box"><p class="label">Definition</p><p>${a.def}</p></div>` : ''}
        ${a.thinkers ? `<div class="box box-accent"><p class="label">Thinkers</p><p>${a.thinkers}</p></div>` : ''}
        ${a.analysis ? `<div class="box box-accent"><p class="label">Analysis</p><p>${a.analysis}</p></div>` : ''}
        ${a.material ? `<div class="box box-warn"><p class="label">Material</p><p>${a.material}</p></div>` : ''}
        ${a.danger ? `<div class="box box-danger"><p class="label">Warning</p><p>${a.danger}</p></div>` : ''}
        
        <div class="flex flex-col gap-1 mt-2">
            <button class="btn btn-primary" onclick="analyze()" ${!state.apiKey?'disabled':''}>Deep Analysis</button>
        </div>
    `;
}

// Start
render();
</script>
</body>
</html>
